# ============================================
# Voice AI POC - Environment Variables
# ============================================

# Modo de execução: 'local' (microfone/speaker), 'telnyx' ou 'twilio' (telefonia)
MODE=local

# ============================================
# TELNYX (Telefonia) - Só necessário se MODE=telnyx
# ============================================
TELNYX_API_KEY=your_telnyx_api_key
TELNYX_CONNECTION_ID=your_connection_id
TELNYX_PHONE_NUMBER=+5511999999999

# ============================================
# TWILIO (Telefonia) - Só necessário se MODE=twilio
# ============================================
TWILIO_ACCOUNT_SID=ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
TWILIO_AUTH_TOKEN=your_twilio_auth_token
TWILIO_PHONE_NUMBER=+18148133621
# Número para testes (usado por npm run twilio:test)
TWILIO_TEST_NUMBER=+5511999999999

# ============================================
# OPENAI (LLM)
# ============================================
OPENAI_API_KEY=your_openai_api_key

# Modelo do LLM - Opções (ordenadas por latência):
# - gpt-3.5-turbo: ~300-500ms TTFT, qualidade aceitável
# - gpt-4o-mini: ~400-900ms TTFT, boa qualidade (RECOMENDADO)
# - gpt-4o: ~800-1200ms TTFT, excelente qualidade
LLM_MODEL=gpt-4o-mini

# ============================================
# STT (Speech-to-Text)
# ============================================
# Provider: 'elevenlabs' (Scribe streaming ~100-300ms) ou 'openai' (Whisper batch ~800-2000ms)
STT_PROVIDER=elevenlabs

# VAD Silence Threshold: tempo de silêncio (ms) para considerar fim da fala
# NOTA: Sistema de "cancelar e reprocessar" está ativo - se usuário continuar
# falando após pausa, o processamento é cancelado e aguarda fala completa
# - 300ms: muito agressivo - muitos cancelamentos
# - 500ms: equilibrado (RECOMENDADO com sistema de reprocessamento)
# - 700ms: conservador - menos cancelamentos, maior latência
VAD_SILENCE_MS=500

# VAD Threshold: sensibilidade do detector de fala (0.1-0.9)
# Maior = menos sensível a ruído, menor = mais sensível a fala
# - 0.3-0.4: muito sensível (pode captar ruído de fundo como fala)
# - 0.5: equilibrado (RECOMENDADO - captura frases curtas como "Sim/Não")
# - 0.7-0.9: agressivo (pode ignorar fala baixa/curta)
VAD_THRESHOLD=0.5

# Min Speech Duration: duração mínima (ms) para considerar fala válida
# Filtra ruídos curtos (cliques, estalos) vs fala real
# - 50-100ms: sensível (RECOMENDADO para "Sim/Não/Já" - frases ~100-200ms)
# - 150-200ms: equilibrado (pode cortar "Sim" muito rápido)
# - 300-500ms: conservador (corta respostas curtas)
MIN_SPEECH_DURATION_MS=100

# Acknowledgments: onomatopeias de escuta ativa ("Uhum", "Hm", "Certo")
# Tocadas quando usuário continua falando após uma pausa
# true = habilitado (padrão), false = desabilitado
ACKNOWLEDGMENTS_ENABLED=true

# ============================================
# ELEVENLABS (TTS + STT Scribe)
# ============================================
# TTS: ~75-100ms TTFB, excelente qualidade de voz
# STT: Scribe streaming ~100-300ms
ELEVENLABS_API_KEY=your_elevenlabs_api_key
ELEVENLABS_VOICE_ID=pFZP5JQG7iQjIQuC4Bku

# ============================================
# OTIMIZAÇÕES DE LATÊNCIA
# ============================================

# Usar prompt reduzido (~70% menos tokens, menor latência no 1º turno)
# true = prompt slim, false = prompt completo
SLIM_PROMPT=false

# Pré-carregar fillers de áudio no startup (latência zero durante chamada)
FILLERS_PRELOAD_ON_STARTUP=true

# ============================================
# THINKING ENGINE (experimental)
# ============================================
# Quando habilitado, faz uma chamada LLM adicional por turno (durante playback)
# para processar "pensamentos internos" do agente (metacognição)
# 
# Benefícios: Melhor coerência e raciocínio estratégico na conversa
# Trade-off: ~2x tokens consumidos por turno
#
# Recomendação: Manter false para produção até validar valor vs custo
ENABLE_THINKING_ENGINE=false

# ============================================
# SERVER
# ============================================
PORT=3000
HOST=0.0.0.0
WEBHOOK_URL=https://your-domain.com/webhook

# ============================================
# CANCELAMENTO DE ECO (AEC) - Só para modo local
# ============================================
# Permite usar sem fones de ouvido, filtrando eco do agente captado pelo mic
# true = habilitado (padrão), false = desabilitado
AEC_ENABLED=true

# Threshold de correlação para detectar eco (0.0-1.0)
# - 0.2-0.3: muito sensível (pode bloquear fala do usuário)
# - 0.35: equilibrado (RECOMENDADO)
# - 0.5-0.7: menos sensível (deixa passar mais eco)
AEC_THRESHOLD=0.35

# ============================================
# DEBUG
# ============================================
LOG_LEVEL=info

# ============================================
# MODO LOCAL (opcional - para personalizar conversa)
# ============================================
PROSPECT_NAME=João
PROSPECT_COMPANY=Empresa Teste

# ============================================
# BENCHMARKS DE REFERÊNCIA (Cloud(x) 2025)
# ============================================
# 
# | Stack                          | TTFA (1º turno) | TTFA (subseq.) |
# |--------------------------------|-----------------|----------------|
# | GPT-4o-mini + ElevenLabs       | ~1.2-1.5s       | ~0.7-1.0s      |
# | GPT-3.5-turbo + ElevenLabs     | ~0.9-1.2s       | ~0.5-0.8s      |
#
# Target de latência aceitável: < 1500ms (ITU-T G.114: < 400ms é "natural")
